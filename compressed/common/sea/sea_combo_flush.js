"use strict";function setComboHash(e){var t=e.length;if(!(t<2)){data.comboSyntax&&(comboSyntax=data.comboSyntax),data.comboMaxLength&&(comboMaxLength=data.comboMaxLength),data.comboSuffix&&(comboSuffix=data.comboSuffix),comboExcludes=data.comboExcludes;for(var a=[],s=0;s<t;s++){var o=e[s];if(!comboHash[o])Module.get(o).status<FETCHING&&!isExcluded(o)&&!isComboUri(o)&&a.push(o)}1<a.length&&paths2hash(uris2paths(a))}}function setRequestUri(e){e.requestUri=comboHash[e.uri]||e.uri}function uris2paths(e){return meta2paths(uris2meta(e))}function uris2meta(e){for(var t={__KEYS:[]},a=0,s=e.length;a<s;a++)for(var o=e[a].replace("://","__").split("/"),n=t,r=0,u=o.length;r<u;r++){var c=o[r];n[c]||(n[c]={__KEYS:[]},n.__KEYS.push(c)),n=n[c]}return t}function meta2paths(e){for(var t=[],a=e.__KEYS,s=0,o=a.length;s<o;s++){for(var n=a[s],r=n,u=e[n],c=u.__KEYS;1===c.length;)r+="/"+c[0],c=(u=u[c[0]]).__KEYS;c.length&&t.push([r.replace("__","://"),meta2arr(u)])}return t}function meta2arr(e){for(var t=[],a=e.__KEYS,s=0,o=a.length;s<o;s++){var n=a[s],r=meta2arr(e[n]),u=r.length;if(u)for(var c=0;c<u;c++)t.push(n+"/"+r[c]);else t.push(n)}return t}function paths2hash(e){for(var t=0,a=e.length;t<a;t++)for(var s=e[t],o=s[0]+"/",n=files2group(s[1]),r=0,u=n.length;r<u;r++)setHash(o,n[r]);return comboHash}function setHash(e,t){for(var a=[],s=0,o=t.length;s<o;s++)a[s]=t[s].replace(/\?.*$/,"");var n=e+comboSyntax[0]+a.join(comboSyntax[1]);comboSuffix&&(n+=comboSuffix);var r=n.length>comboMaxLength;if(1<t.length&&r){var u=splitFiles(t,comboMaxLength-(e+comboSyntax[0]).length);setHash(e,u[0]),setHash(e,u[1])}else{if(r)throw new Error("The combo url is too long: "+n);for(s=0,o=t.length;s<o;s++)comboHash[e+t[s]]=n}}function splitFiles(e,t){for(var a=comboSyntax[1],s=e[0],o=1,n=e.length;o<n;o++)if((s+=a+e[o]).length>t)return[e.splice(0,o),e]}function files2group(e){for(var t=[],a={},s=0,o=e.length;s<o;s++){var n=e[s],r=getExt(n);r&&(a[r]||(a[r]=[])).push(n)}for(var u in a)a.hasOwnProperty(u)&&t.push(a[u]);return t}function getExt(e){var t=e.lastIndexOf(".");return 0<=t?e.substring(t):""}function isExcluded(e){return comboExcludes?comboExcludes.test?comboExcludes.test(e):comboExcludes(e):void 0}function isComboUri(e){var t=data.comboSyntax||["??",","],a=t[0],s=t[1];return a&&0<e.indexOf(a)||s&&0<e.indexOf(s)}function flush(e){var t=e.length;if(0!==t){for(var a=e.splice(0,t),s=[],o=0;o<t;o++)s=s.concat(a[o].resolve());s=getUnfetchedUris(s);var n=Module.get(data.cwd+"_flush_"+data.cid(),s);n.load=load,n._entry.push(n),n.history={},n.remain=1,n.callback=function(){for(var e=0;e<t;e++)a[e].onload();delete n.callback,delete n.history,delete n.remain,delete n._entry},n.load()}}function needLoadImmediately(e){return hasEmptyDependencies(e)||isSavedBeforeRequest(e)||isAsync(e)}function isSavedBeforeRequest(e){return!isLoadOnRequest&&e.status===Module.STATUS.SAVED}function hasEmptyDependencies(e){return 0===e.dependencies.length}function isAsync(e){return ASYNC_RE.test(e.uri)}function getUnfetchedUris(e){for(var t,a=[],s={},o=0,n=e.length;o<n;o++)(t=e[o])&&!s[t]&&(s[t]=!0,(!seajs.cache[t]||seajs.cache[t].status<Module.STATUS.SAVED)&&a.push(t));return a}var comboExcludes,comboSuffix,FETCHING=(Module=seajs.Module).STATUS.FETCHING,comboHash=(data=seajs.data).comboHash={},comboSyntax=["??",","],comboMaxLength=2e3;if(seajs.on("load",setComboHash),seajs.on("fetch",setRequestUri),data.test){var test=seajs.test||(seajs.test={});test.uris2paths=uris2paths,test.paths2hash=paths2hash}var Module,data,load=(Module=seajs.Module).prototype.load,useStack=(data=seajs.data).flushUseStack=[],depStack=data.flushDepStack=[],isLoadOnRequest=!1,isInUse=!1;Module.prototype.load=function(){needLoadImmediately(this)?load.call(this):isInUse?useStack.push(this):depStack.push(this)},seajs.use=function(e,t){return isInUse=!0,Module.use(e,t,data.cwd+"_use_"+data.cid()),isInUse=!1,seajs},seajs.flush=function(){flush(useStack)},seajs.on("request",function(e){var t=e.onRequest;e.onRequest=function(){isLoadOnRequest=!0,t(),isLoadOnRequest=!1,flush(depStack)}});var ASYNC_RE=/\.js_async_\d+$/;