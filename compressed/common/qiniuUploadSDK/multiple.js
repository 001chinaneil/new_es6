"use strict";$(function(){Qiniu.uploader({runtimes:"html5,flash,html4",browse_button:"pickfiles",container:"container",drop_element:"container",max_file_size:"100mb",flash_swf_url:"js/plupload/Moxie.swf",dragdrop:!0,chunk_size:"4mb",uptoken_url:$("#uptoken_url").val(),domain:$("#domain").val(),auto_start:!0,init:{FilesAdded:function(e,o){$("table").show(),$("#success").hide(),plupload.each(o,function(e){new FileProgress(e,"fsUploadProgress").setStatus("等待...")})},BeforeUpload:function(e,o){var s=new FileProgress(o,"fsUploadProgress"),a=plupload.parseSize(this.getOption("chunk_size"));"html5"===e.runtime&&a&&s.setChunkProgess(a)},UploadProgress:function(e,o){var s=new FileProgress(o,"fsUploadProgress"),a=plupload.parseSize(this.getOption("chunk_size"));s.setProgress(o.percent+"%",o.speed,a)},UploadComplete:function(){$("#success").show()},FileUploaded:function(e,o,s){new FileProgress(o,"fsUploadProgress").setComplete(e,s)},Error:function(e,o,s){$("table").show();var a=new FileProgress(o.file,"fsUploadProgress");a.setError(),a.setStatus(s)}}}).bind("FileUploaded",function(){console.log("hello man,a file is uploaded")}),(new QiniuJsSDK).uploader({runtimes:"html5,flash,html4",browse_button:"pickfiles2",container:"container2",drop_element:"container2",max_file_size:"100mb",flash_swf_url:"js/plupload/Moxie.swf",dragdrop:!0,chunk_size:"4mb",uptoken_url:$("#uptoken_url").val(),domain:$("#domain").val(),auto_start:!0,init:{FilesAdded:function(e,o){$("table").show(),$("#success").hide(),plupload.each(o,function(e){new FileProgress(e,"fsUploadProgress").setStatus("等待...")})},BeforeUpload:function(e,o){var s=new FileProgress(o,"fsUploadProgress"),a=plupload.parseSize(this.getOption("chunk_size"));"html5"===e.runtime&&a&&s.setChunkProgess(a)},UploadProgress:function(e,o){var s=new FileProgress(o,"fsUploadProgress"),a=plupload.parseSize(this.getOption("chunk_size"));s.setProgress(o.percent+"%",o.speed,a)},UploadComplete:function(){$("#success").show()},FileUploaded:function(e,o,s){new FileProgress(o,"fsUploadProgress").setComplete(e,s)},Error:function(e,o,s){$("table").show();var a=new FileProgress(o.file,"fsUploadProgress");a.setError(),a.setStatus(s)}}}).bind("FileUploaded",function(){console.log("hello man 2,a file is uploaded")}),$("#container").on("dragenter",function(e){e.preventDefault(),$("#container").addClass("draging"),e.stopPropagation()}).on("drop",function(e){e.preventDefault(),$("#container").removeClass("draging"),e.stopPropagation()}).on("dragleave",function(e){e.preventDefault(),$("#container").removeClass("draging"),e.stopPropagation()}).on("dragover",function(e){e.preventDefault(),$("#container").addClass("draging"),e.stopPropagation()}),$("#show_code").on("click",function(){$("#myModal-code").modal(),$("pre code").each(function(e,o){hljs.highlightBlock(o)})}),$("body").on("click","table button.btn",function(){$(this).parents("tr").next().toggle()});$("#myModal-img .modal-body-footer").find("a").on("click",function(){var e=$("#myModal-img").find(".modal-body img"),o=e.data("key"),s=e.attr("src"),t=parseInt(e.data("h"),10),r=[],a=function(e){if(!e)return 0;for(var o=e.split("/"),s=0,a=o.length;s<a;s++)if("rotate"===o[s])return parseInt(o[s+1],10);return 0}(s);if($(this).hasClass("no-disable-click")){$(this).siblings().removeClass("disabled");var i=$(this).data("imagemogr");"left"===i?a=a-90<0?a+270:a-90:"right"===i&&(a=360<a+90?a-270:a+90),r.push({fop:"imageMogr2","auto-orient":!0,strip:!0,rotate:a,format:"png"})}else $(this).addClass("disabled").siblings().removeClass("disabled"),"no-rotate"!==$(this).data("imagemogr")&&r.push({fop:"imageMogr2","auto-orient":!0,strip:!0,rotate:a,format:"png"});$("#myModal-img .modal-body-footer").find("a.disabled").each(function(){var e=$(this).data("watermark"),o=$(this).data("imageview"),s=$(this).data("imagemogr");if(e&&r.push({fop:"watermark",mode:1,image:"http://www.b1.qiniudn.com/images/logo-2.png",dissolve:100,gravity:e,dx:100,dy:100}),o){var a;switch(o){case"large":a=t;break;case"middle":a=.5*t;break;case"small":a=.1*t;break;default:a=t}r.push({fop:"imageView2",mode:3,h:parseInt(a,10),q:100,format:"png"})}"no-rotate"===s&&r.push({fop:"imageMogr2","auto-orient":!0,strip:!0,rotate:0,format:"png"})});var n=Qiniu.pipeline(r,o),l=new Image;return e.attr("src","images/loading.gif"),l.onload=function(){e.attr("src",n),e.parent("a").attr("href",n)},l.src=n,!1})});