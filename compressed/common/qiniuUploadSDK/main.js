"use strict";$(function(){var e=Qiniu.uploader({disable_statistics_report:!1,runtimes:"html5,flash,html4",browse_button:"pickfiles",container:"container",drop_element:"container",max_file_size:"1000mb",flash_swf_url:"bower_components/plupload/js/Moxie.swf",dragdrop:!0,chunk_size:"4mb",multi_selection:!("ios"===moxie.core.utils.Env.OS.toLowerCase()),uptoken:"xozWSPMxkMjIVoHg2JyXq4-7-oJaEADLOKHVR0vU:UBacI3dr-tionRT-PyVtJfhdzjQ=:eyJkZWxldGVBZnRlckRheXMiOjcsInNjb3BlIjoianNzZGsiLCJkZWFkbGluZSI6MTUxNTU1MzYwMH0=",domain:$("#domain").val(),get_new_uptoken:!1,auto_start:!0,log_level:5,init:{BeforeChunkUpload:function(e,o){console.log("before chunk upload:",o.name),console.log(o)},FilesAdded:function(a,e){$("table").show(),$("#success").hide(),plupload.each(e,function(e){var o=new FileProgress(e,"fsUploadProgress");o.setStatus("等待..."),o.bindUploadCancel(a)})},BeforeUpload:function(e,o){console.log("this is a beforeupload function from init");var a=new FileProgress(o,"fsUploadProgress"),t=plupload.parseSize(this.getOption("chunk_size"));"html5"===e.runtime&&t&&a.setChunkProgess(t)},UploadProgress:function(e,o){var a=new FileProgress(o,"fsUploadProgress"),t=plupload.parseSize(this.getOption("chunk_size"));a.setProgress(o.percent+"%",o.speed,t)},UploadComplete:function(){$("#success").show()},FileUploaded:function(e,o,a){var t=new FileProgress(o,"fsUploadProgress");console.log("response:",a.response),t.setComplete(e,a.response)},Error:function(e,o,a){$("table").show();var t=new FileProgress(o.file,"fsUploadProgress");t.setError(),t.setStatus(a)}}});e.bind("BeforeUpload",function(){console.log("hello man, i am going to upload a file")}),e.bind("FileUploaded",function(){console.log("hello man,a file is uploaded")}),$("#container").on("dragenter",function(e){e.preventDefault(),$("#container").addClass("draging"),e.stopPropagation()}).on("drop",function(e){e.preventDefault(),$("#container").removeClass("draging"),e.stopPropagation()}).on("dragleave",function(e){e.preventDefault(),$("#container").removeClass("draging"),e.stopPropagation()}).on("dragover",function(e){e.preventDefault(),$("#container").addClass("draging"),e.stopPropagation()}),$("#show_code").on("click",function(){$("#myModal-code").modal(),$("pre code").each(function(e,o){hljs.highlightBlock(o)})}),$("body").on("click","table button.btn",function(){$(this).parents("tr").next().toggle()});$("#myModal-img .modal-body-footer").find("a").on("click",function(){var e=$("#myModal-img").find(".modal-body img"),o=e.data("key"),a=e.attr("src"),n=parseInt(e.data("h"),10),i=[],t=function(e){if(!e)return 0;for(var o=e.split("/"),a=0,t=o.length;a<t;a++)if("rotate"===o[a])return parseInt(o[a+1],10);return 0}(a);if($(this).hasClass("no-disable-click")){$(this).siblings().removeClass("disabled");var s=$(this).data("imagemogr");"left"===s?t=t-90<0?t+270:t-90:"right"===s&&(t=360<t+90?t-270:t+90),i.push({fop:"imageMogr2","auto-orient":!0,strip:!0,rotate:t,format:"png"})}else $(this).addClass("disabled").siblings().removeClass("disabled"),"no-rotate"!==$(this).data("imagemogr")&&i.push({fop:"imageMogr2","auto-orient":!0,strip:!0,rotate:t,format:"png"});$("#myModal-img .modal-body-footer").find("a.disabled").each(function(){var e=$(this).data("watermark"),o=$(this).data("imageview"),a=$(this).data("imagemogr");if(e&&i.push({fop:"watermark",mode:1,image:"http://www.b1.qiniudn.com/images/logo-2.png",dissolve:100,gravity:e,dx:100,dy:100}),o){var t;switch(o){case"large":t=n;break;case"middle":t=.5*n;break;case"small":t=.1*n;break;default:t=n}i.push({fop:"imageView2",mode:3,h:parseInt(t,10),q:100,format:"png"})}"no-rotate"===a&&i.push({fop:"imageMogr2","auto-orient":!0,strip:!0,rotate:0,format:"png"})});var r=Qiniu.pipeline(i,o),l=new Image;return e.attr("src","images/loading.gif"),l.onload=function(){e.attr("src",r),e.parent("a").attr("href",r)},l.src=r,!1})});